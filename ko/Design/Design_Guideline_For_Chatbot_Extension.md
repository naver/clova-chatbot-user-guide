# Extension 디자인 가이드라인

Chatbot extension은 Clova를 통해 사용자에게 고객 지원 도움말이나 간단한 대화 서비스를 제공할 수 있습니다. 이 문서는 사용자에게 건전하고 유익한 서비스를 제공하기 위해 chatbot extension을 설계할 때 어떤 사항을 지키거나 따라야 하는지 가이드라인을 제공합니다. 참고로 여기서 다루는 내용은 chatbot extension 설계의 기본 권장 사항이며 간단한 예시와 함께 설명하고 있습니다.

* [Interaction 모델 정의](#DefineInteractionModel)
* [유의사항](#Precautions)
* [지속적인 업데이트](#ContinuousUpdate)

## Interaction 모델 정의 {#DefineInteractionModel}
Chatbot extension의 interaction 모델을 정의하는 것은 사용자 발화 유형을 정의하고 발화 유형에 따라 발화 예시와 그에 상응하는 답변을 정의하는 것입니다. 다음과 같은 내용을 정의해야 합니다.

* [사용자 발화 유형](#TypeOfUserUtterance)
* [발화 예시](#UtteranceExamples)
* [변수 사전](#VariableDictionary)
* [발화 유형별 답변](#ResponsesForEachUtteranceType)

### 사용자 발화 유형 {#DefineTypeOfUserUtterance}

Chatbot extension의 interaction 모델을 정의할 때 가장 먼저 할 일은 chatbot extension이 대응해야 할 사용자 발화의 유형을 정의하는 것입니다. 사용자의 발화 유형은 같은 유형의 [발화 예시](#UtteranceExamples)에 어떤 [답변](#ResponsesForEachUtteranceType)할 것인지 나누는 논리적 단위가 됩니다. 예를 들면, 회원제로 운영하는 쇼핑몰 서비스의 고객 문의에 대응하는 Chattbot extension을 만든다고 가정하면 다음과 같은 사용자의 문의가 들어온다고 정의하거나 예측할 수 있습니다. 이런 류의 서비스는 발화 유형을 통해 정보를 제공하는 목적으로 사용자와 대화하게 됩니다.

```
* 회원 관련 문의
  * 가입 문의
  * 계정 찾기 문의
  * 회원 정보 변경 문의
  * 탈퇴 문의
* 결제 문의
  * 상품 구입 방법
  * 쿠폰 사용/적립금 사용 방법
  * 주문 정보 확인 방법
  * 상품 환불 방법
* 배송 문의
  * 배송 조회 방법
  * 배송지 변경 방법
  * 반품 방법
...
```

또는, 말벗 서비스와 같이 간단한 대화 서비스를 제공한다고 하면 다음과 같이 발화 유형을 정의해볼 수도 있습니다. 이때는 주로 친교나 정서 표현의 목적으로 사용자와 대화하게 됩니다.

```
* 인사
  * 시작/안부 인사
  * 작별 인사
* 소개
  * 사용자 본인 소개
  * 챗봇 소개 요청
    * 챗봇 이름 요청
    * 챗봇 성별 요청
    * 챗봇 나이 요청
    * 챗봇 거주지 요청
  * 챗봇 이용 방법 요청
* 정서적인 표현
  * 사용자가 기쁨을 표출하는 유형
  * 사용자가 분노를 표출하는 유형
  * 사용자가 호감을 표출하는 유형
  * 사용자가 슬픔을 표출하는 유형
...
```

### 발화 예시 {#UtteranceExamples}

Chatbot extension이 대응할 사용자의 [발화 유형을 정의](#DefineTypeOfUserUtterance)했다면 각 유형별로 어떤 사용자의 요청이 들어올지 발화 예시를 작성합니다. 하나의 발화 유형에는 **같은 답변을 가질 수 있는 모든 발화 예시**를 작성하면 됩니다. 발화 예시를 작성할 때는 다음을 고려하여 작성할 것을 권장합니다.

* 문어체보다는 구어체로 작성합니다.
* 같은 의도를 지녔지만 다른 방식으로 표현이 되는 발화 예시를 많이 입력해야 합니다.
* 발화 예시 작성 개수는 발화 유형당 10~15개를 작성해야 합니다.
* 반복적인 패턴의 표현은 피하고 다양한 변형을 주어 발화 예시를 작성합니다. 이 부분에 대해서는 [변수 사전](#VariableDictionary)에서 다룹니다.
* 위 기준으로 발화 예시를 입력한 후 새로운 표현이 생기거나 인식이 잘 안 되는 표현을 발견할 때마다 발화 예시를 추가하는 것이 좋습니다.

앞서 언급했던 발화 유형 예 중에 발화 유형이 "가입 문의"에 해당하는 발화 예시를 작성해보면 다음과 같을 수 있습니다.

```
회원 가입하고 싶어요.
회원 가입 방법을 알려주세요.
회원 가입하려면 어떻게해야 하나요?
멤버 등록하고 싶어요.
멤버 등록 방법을 알려주세요.
멤버 등록하려면 어떻게해야 하나요?
계정 생성하고 싶어요.
계정 생성 방법을 알려주세요.
계정 생성하려면 어떻게해야 하나요?
...
```

"가입 문의" 발화 유형에는 정말 다양한 표현이 있을 수 있으며, 위에 작성된 발화 예시는 표현은 다르지만 모두 같은 의미를 지니며, 같은 답변으로 대응할 수 있음을 파악할 수 있다. 이런 식으로 "가입 문의"에 해당하는 발화 예시 뿐만 아니라 정의한 발화 유형에 맞는 발화 예시를 작성해야 한다.

### 변수 사전 {#VariableDictionary}

발화 예시를 작성하다보면 예시문이 특정 패턴으로 되는 경우가 많으며, 주어나 목적어와 같이 명사 형태의 일부 품사들이 비슷한 의미나 범주를 가진 다양한 값으로 표현될 수 있지만 의미가 바뀌지 않는 것을 알 수 있습니다. 예를 들면, [발화 예시](#UtteranceExamples)에서 언급한 "회원 가입", "멤버 등록", "계정 생성"이라는 표현은 같은 의미를 지니는 요소들로서 같은 패턴의 문장에서 어떤 값이 들어와도 문장의 의미가 바뀌지 않습니다.

![](/Design/Resources/Images/Clova_Chatbot_Extension_Dictionary_for_Variable.png)

Chatbot extension의 interaction 모델에서는 이런 부분을 변수라고 지칭하고, 변수 자리에 들어올 수 있는 값의 목록을 변수 사전이라고 부릅니다. 앞서 나열한 발화 예시는 변수를 이용해서 표현하면 다음과 같은 패턴으로 표현할 수 있습니다.

{% raw %}
```
{{변수}}하고 싶어요.
{{변수}} 방법을 알려주세요.
{{변수}}하려면 어떻게해야 하나요?
```
{% endraw %}

일반적으로 변수 사전은 유의어나 동의어의 집합이 될 수도 있으나 상위 분류나 개념이 같은 용어나 특정 속성이 같은 용어의 집합일 수도 있습니다. 예를 들면, NAVER 카페, NAVER 블로그, NAVER 뮤직, NAVER 메일 등의 서비스 용어는 유의어나 동의어라고 할 수는 없으나 NAVER 계정으로 서비스된다는 공통된 속성이 있습니다. 따라서 각 서비스의 회원 가입 문의는 NAVER 계정 생성과 같은 문의이므로 같은 사전에 속한 변수로 사용할 수 있게 됩니다.

{% raw %}
```
NAVER 메일 가입 방법 알려주세요.
NAVER 카페 가입 방법 알려주세요.
NAVER 블로그 가입 방법 알려주세요.
NAVER 뮤직 가입 방법 알려주세요.
...
```
{% endraw %}

따라서 위 발화 예시는 "NAVER 서비스"라는 변수 사전을 만들고 이 사전을 참조하는 변수로 반복 없이 한 번에 표현될 수 있습니다.

{% raw %}
```
{{NAVER 서비스}} 가입 방법 알려주세요.

// 변수 사전 선언
NAVER 서비스=NAVER 메일, NAVER 카페, NAVER 블로그, NAVER 뮤직
...
```
{% endraw %}

### 발화 유형별 답변 {#ResponsesForEachUtteranceType}

발화 유형을 정의했고 발화 예시까지 작성했다면 사용자에게 어떻게 답변할지 작성해야 합니다. 고객 센터 지원 도움말 형태의 서비스라면 사용자가 문의한 내용에 대한 정보나 가이드를 말벗 서비스 형태라면 대화에 맞는 답변을 하면 됩니다. 답변이 발음 오류나 임의의 끊어 읽기 없이 자연스럽게 발음되려면 다음과 같은 규칙을 지켜야 합니다.

* 문법에 맞게 답변을 작성합니다.
* 문장을 작성할 때 조사를 포함하여 간결하게 작성합니다. 조사를 포함하지 않은 문자은 부자연스럽게 읽힐 가능성이 높습니다.
* 띄어쓰기를 지켜주는 것이 좋습니다. 띄어쓰기를 지키지 않으면 발음 오류가 발생할 수도 있고 원하지 않는 부분에서 답변이 부자연스럽게 끊어져 읽힐 수도 있습니다.
* 문장 부호를 적절히 쓰는 것이 좋습니다.
* 숫자, 영어, 기호 표현은 음차 표현으로 작성하는 것이 좋습니다. 다음은 음차 표현을 한 예입니다.
  * 2080: 이천팔십 또는 이공팔공
  * 3M: 쓰리엠, 삼 미터 또는 삼 메가
  * 1/3: 일월 삼일 또는 삼분의 일
* 약어 또한 풀어서 한글로 쓰는 것이 좋습니다. 예를 들면, TG와 같은 약어는 톨게이트로 풀어쓰는 것이 좋습니다.
* 여러 단계에 걸쳐서 안내를 하려면 답변하는 문장 앞에 "첫 번재", "그 다음에는", "마지막으로" 등과 같은 표현을 넣는 것이 좋습니다.

예를 들면, "가입 문의" 발화 유형에 대해 다음과 같은 답변을 작성할 수 있습니다.

```
회원가입은 NAVER 홈페이지에서 하실 수 있으며, 로그인 영역 하단의 회원가입 링크를 통해 진행하실 수 있습니다.
```

일반적으로 고객 센터 지원 도움말 형태의 서비스는 하나의 발화 유형에 하나의 답변이 작성되나 말벗 서비스의 경우에는 하나의 발화 유형에 다양한 답변을 준비해놓을 수 있습니다. 물론, 하나의 발화 유형에 답변은 여러 개를 등록할 수 있지만 실제 대화 시 하나의 답변만 사용자에게 전달됩니다. 예를 들어 말벗 서비스에서 사용자의 발화 중 "챗봇 나이 요청" 발화 유형에 대한 답변으로 다음과 같은 답변을 준비해둘 수 있습니다.

```
나이가 중요한가요?
맞춰보세요.
비밀이에요.
```

등록된 복수의 답변 중에 어떤 답변을 응답으로 줄지는 다음과 같이 두 가지 방법으로 결정할 수 있습니다.

* 여러 답변 중 특정 답변을 전달하도록 지정할 수 있습니다.
* 여러 답변 중 불규칙한 방식으로 임의의 답변을 사용자에게 전달하도록 지정할 수 있습니다.

발화 유형별 답변까지 작성하고 나면 interaction 모델을 다음과 같이 표 형태로 나타내서 정리할 수 있습니다.

<table>
  <thead>
    <tr>
      <th width="15%">서비스 형태</th><th width="15%">발화 유형 분류</th><th width="35%">발화 예시</th><th width="35%">답변</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>고객 센터 지원 도움말</td>
      <td>가입 문의</td>
      <td>
        <ul>
          <li>회원 가입하고 싶어요.</li>
          <li>멤버 등록 방법을 알려주세요.</li>
          <li>계정 생성하려면 어떻게 해야 하나요?</li>
        </ul>
      </td>
      <td>
        <ul>
          <li>회원가입은 NAVER 홈페이지에서 하실 수 있으며, 로그인 영역 하단의 회원가입 링크를 통해 진행하실 수 있습니다.</li>
        </ul>
      </td>
    </tr>
    <tr>
      <td>말벗 서비스</td>
      <td>챗봇 나이 요청</td>
      <td>
        <ul>
          <li>몇 살이야?</li>
          <li>나이가 어떻게 돼?</li>
        </ul>
      </td>
      <td>
        <ul>
          <li>나이가 중요한가요?</li>
          <li>맞춰보세요.</li>
          <li>비밀이에요.</li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

## 유의사항 {#Precautions}

Extension을 설계할 때 다음과 같은 사회적인 또는 법적인 문제가 없는지 미리 파악하여 문제가 발생하지 않도록 반드시 주의해야 합니다. Extension을 설계하는 단계뿐만 아니라 extension을 Clova에 등록하거나 배포할 때에도 아래 사항을 한 번 더 검토할 것을 권고합니다.

* 저작권 보호 의무에 대한 위반 사항이 없는지 검토
* 개인 정보 보호 의무에 대한 위반 사항이 없는지 검토
* 서비스 연결이나 데이터 제공이 일회적이지 않고 지속적일 수 있는지 검토
* 아동 또는 일반 사용자에게 해를 줄 수 있는 선정적인 콘텐츠가 없는지 검토

## 지속적인 업데이트 {#ContinuousUpdate}

Chatbot extension을 개발할 때 사용자가 입력한 발화 유형의 발화 예시에 맞게 발화를 하지 않을 수도 있습니다. 사용자들이 실제 이용하는 방식가 차이가 있을 수 있고 사용자의 모든 사용 패턴을 대변했다고 할 수 없습니다. 즉, 사용자는 예상과 다르게 chatbot extension을 사용하려고 할 수 있습니다. 따라서, chatbot extension을 배포한 이후에도 chatbot extension의 발화 유형이나 발화 예시를 지속적으로 개선하는 활동을 해야 사용자의 만족도를 향상시킬 수 있습니다.

Chatbot extension 등록한 후 Clova 플랫폼이 제공하는 통계 데이터나 유입된 사용자 발화 기록(추후 제공 예정) 분석하여 꾸준히 chatbot extension을 업데이트해야 합니다.
